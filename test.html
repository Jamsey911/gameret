def all_products(request):
    """ A view to show all products, including sorting and search queries """

    # ... [the code you have to get the products]

    # Pagination
    paginator = Paginator(products, 12)  # Show 12 products per page (change the number as you see fit)
    page = request.GET.get('page')
    paged_products = paginator.get_page(page)

    current_sorting = f'{sort}_{direction}'

    context = {
        'products': paged_products,  # Make sure to pass the paged products, not all products
        'search_term': query,
        'current_categories': categories,
        'current_sorting': current_sorting,
    }

    return render(request, 'products/products.html', context)



{% if products.has_previous %}

<a href="?page=1">&laquo First</a>
<a href="?page={{ products.previous_page_number }}">Previous</a>

{% endif %}
Page {{ products.number }} of {{products.paginator.num_pages }}

{% if products.has_next %}

<a href="?page={{ products.next_page_number }}">Next</a>
<a href="?page={{ products.paginator.num_pages }}">Last &raquo;</a>

{% endif %}


context = {
    'search_term': query,
    'current_categories': categories,
    'current_sorting': current_sorting,
}